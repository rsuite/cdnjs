/*
 Copyright (c) 2013-2016, Nazar Mokrynskyi
 @copyright Copyright (c) 2008-2009, Stefan Petre
 @license   MIT License, see license.txt
*/
(function(G,y){"function"===typeof define&&define.amd?define(y):"object"===typeof exports?module.exports=y():G.pickmeup=y()})(this,function(){function G(a,d,c){c=c||[];if(a instanceof Element)d.apply(d,[a].concat(c));else{var b,e;b=a.length;for(e=0;e<b;++e)d.apply(d,[a[e]].concat(c))}}function y(a){G(a,function(a){a.parentElement.removeChild(a)})}function J(a,d){do a=a.parentElement;while(a&&!C(a,d));return a}function C(a,d){return(a.matches||a.webkitMatchesSelector||a.msMatchesSelector).call(a,d)}
function n(a,d){return a&&a.classList.contains(d)}function l(a,d){a.classList.add(d)}function q(a,d,c,b){if(-1!==c.indexOf(" ")){c=c.split(" ");var e=c.length,k;for(k=0;k<e;++k)q(a,d,c[k],b)}else a.__pickmeup.events.push([d,c,b]),d.addEventListener(c,b)}function z(a,d,c,b){var e,k,f;if(-1!==c.indexOf(" "))for(e=c.split(" "),k=e.length,f=0;f<k;++f)z(a,d,e[f],b);else for(e=a.__pickmeup.events,k=e.length,f=0;f<k;++f)d&&d!=e[f][0]||c&&c!=e[f][1]||b&&b!=e[f][2]||e[f][0].removeEventListener(e[f][1],e[f][2])}
function M(a){a=a.getBoundingClientRect();return{top:a.top+window.pageYOffset-document.documentElement.clientTop,left:a.left+window.pageXOffset-document.documentElement.clientLeft}}function D(a,d,c){var b=document.createEvent("Event");c&&(b.detail=c);b.initEvent("pickmeup-"+d,!1,!0);return a.dispatchEvent(b)}function K(a){a=new Date(a);for(var d=28,c=a.getMonth();a.getMonth()==c;)++d,a.setDate(d);return d-1}function A(a,d){a.setDate(a.getDate()+d)}function r(a,d){var c=a.getDate();a.setDate(1);a.setMonth(a.getMonth()+
d);a.setDate(Math.min(c,K(a)))}function v(a,d){var c=a.getDate();a.setDate(1);a.setFullYear(a.getFullYear()+d);a.setDate(Math.min(c,K(a)))}function N(a){var d=a.__pickmeup.element,c=a.__pickmeup.options;a=Math.floor(c.calendars/2);var b=c.date,e=c.current,k=c.min?new Date(c.min):null,f=c.max?new Date(c.max):null,g,x,p,h,t;k&&(k.setDate(1),r(k,1),A(k,-1));f&&(f.setDate(1),r(f,1),A(f,-1));y(Array.prototype.slice.call(d.querySelectorAll(".pmu-instance \x3e :not(nav)")));for(var w=0;w<c.calendars;w++){g=
new Date(e);B(g);p=Array.prototype.slice.call(d.querySelectorAll(".pmu-instance"))[w];n(d,"pmu-view-years")?(v(g,12*(w-a)),x=g.getFullYear()-6+" - "+(g.getFullYear()+5)):n(d,"pmu-view-months")?(v(g,w-a),x=g.getFullYear()):n(d,"pmu-view-days")&&(r(g,w-a),x=E(g,c.title_format,c.locales[c.locale]));if(!t&&f&&(t=new Date(g),c.select_day?r(t,c.calendars-1):c.select_month?v(t,c.calendars-1):v(t,12*(c.calendars-1)),t>f)){--w;r(e,-1);t=void 0;continue}t=new Date(g);if(!h&&(h=new Date(g),h.setDate(1),r(h,
1),A(h,-1),k&&k>h)){--w;r(e,1);h=void 0;continue}p.querySelector(".pmu-month").textContent=x;var m=function(a){return"range"==c.mode&&a>=(new Date(b[0])).getFullYear()&&a<=(new Date(b[1])).getFullYear()||"multiple"==c.mode&&-1!==b.reduce(function(a,b){a.push((new Date(b)).getFullYear());return a},[]).indexOf(a)||(new Date(b)).getFullYear()==a},q=function(a,d){var e=(new Date(b[0])).getFullYear(),g=(new Date(b[1])).getFullYear(),f=(new Date(b[0])).getMonth(),h=(new Date(b[1])).getMonth();return"range"==
c.mode&&(a>e&&a<g||a>e&&a==g&&d<=h||a==e&&a<g&&d>=f||a==e&&a==g&&d>=f&&d<=h)||"multiple"==c.mode&&-1!==b.reduce(function(a,b){b=new Date(b);a.push(b.getFullYear()+"-"+b.getMonth());return a},[]).indexOf(a+"-"+d)||(new Date(b)).getFullYear()==a&&(new Date(b)).getMonth()==d};(function(){var a=[],b=g.getFullYear()-6,d=(new Date(c.min)).getFullYear(),e=(new Date(c.max)).getFullYear(),f,h,k;for(k=0;12>k;++k)f=b+k,h=document.createElement("div"),h.textContent=f,h.__pickmeup_year=f,c.min&&f<d||c.max&&f>
e?l(h,"pmu-disabled"):m(f)&&l(h,"pmu-selected"),a.push(h);p.appendChild(c.instance_content_template(a,"pmu-years"))})();(function(){var a=[],b=g.getFullYear(),d=(new Date(c.min)).getFullYear(),e=(new Date(c.min)).getMonth(),f=(new Date(c.max)).getFullYear(),h=(new Date(c.max)).getMonth(),k,m;for(k=0;12>k;++k)m=document.createElement("div"),m.textContent=c.locales[c.locale].monthsShort[k],m.__pickmeup_month=k,m.__pickmeup_year=b,c.min&&(b<d||k<e&&b==d)||c.max&&(b>f||k>h&&b>=f)?l(m,"pmu-disabled"):
q(b,k)&&l(m,"pmu-selected"),a.push(m);p.appendChild(c.instance_content_template(a,"pmu-months"))})();(function(){var a=[],b=g.getMonth(),d=B(new Date).valueOf(),e,f,k,h,m;(function(){g.setDate(1);var a=(g.getDay()-c.first_day)%7;A(g,-(a+(0>a?7:0)))})();for(e=0;42>e;++e)f=document.createElement("div"),f.textContent=g.getDate(),f.__pickmeup_day=g.getDate(),f.__pickmeup_month=g.getMonth(),f.__pickmeup_year=g.getFullYear(),b!=g.getMonth()&&l(f,"pmu-not-in-month"),0==g.getDay()?l(f,"pmu-sunday"):6==g.getDay()&&
l(f,"pmu-saturday"),k=c.render(new Date(g))||{},h=g.valueOf(),m=c.min&&c.min>g||c.max&&c.max<g,k.disabled||m?l(f,"pmu-disabled"):(k.selected||c.date.valueOf()==h||c.date instanceof Array&&c.date.reduce(function(a,b){return a||h===b.valueOf()},!1)||"range"==c.mode&&h>=c.date[0]&&h<=c.date[1])&&l(f,"pmu-selected"),h==d&&l(f,"pmu-today"),k.class_name&&k.class_name.split(" ").forEach(l.bind(f,f)),a.push(f),A(g,1);p.appendChild(c.instance_content_template(a,"pmu-days"))})()}h.setDate(1);t.setDate(1);r(t,
1);A(t,-1);x=d.querySelector(".pmu-prev");a=d.querySelector(".pmu-next");x&&(x.style.visibility=c.min&&c.min>=h?"hidden":"visible");a&&(a.style.visibility=c.max&&c.max<=t?"hidden":"visible");D(d,"fill")}function u(a,d){var c=d.format,b=d.separator,e=d.locale;if(a instanceof Date||a instanceof Number)return B(new Date(a));if(!a)return B(new Date);if(a instanceof Array){a=a.slice();for(c=0;c<a.length;++c)a[c]=u(a[c],d);return a}b=a.split(b);if(1<b.length)return b.forEach(function(a,b,c){c[b]=u(a.trim(),
d)}),b;b=e.monthsShort.join(")(")+")("+e.months.join(")(");b=new RegExp("[^0-9a-zA-Z("+b+")]+");a=a.split(b);for(var b=c.split(b),k,f,g,l,p,h=new Date,c=0;c<a.length;c++)switch(b[c]){case "b":f=e.monthsShort.indexOf(a[c]);break;case "B":f=e.months.indexOf(a[c]);break;case "d":case "e":k=parseInt(a[c],10);break;case "m":f=parseInt(a[c],10)-1;break;case "Y":case "y":g=parseInt(a[c],10);g+=100<g?0:29>g?2E3:1900;break;case "H":case "I":case "k":case "l":l=parseInt(a[c],10);break;case "P":case "p":/pm/i.test(a[c])&&
12>l?l+=12:/am/i.test(a[c])&&12<=l&&(l-=12);break;case "M":p=parseInt(a[c],10)}e=new Date(void 0===g?h.getFullYear():g,void 0===f?h.getMonth():f,void 0===k?h.getDate():k,void 0===l?h.getHours():l,void 0===p?h.getMinutes():p,0);isNaN(1*e)&&(e=new Date);return B(e)}function B(a){a.setHours(0,0,0,0);return a}function E(a,d,c){var b=a.getMonth(),e=a.getDate(),k=a.getFullYear(),f=a.getDay(),g=a.getHours(),l=12<=g,p=l?g-12:g,h;h=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0);var n=new Date(a.getFullYear(),
0,0,0,0,0);h=Math.floor((h-n)/24*36E5);0==p&&(p=12);var n=a.getMinutes(),r=a.getSeconds();d=d.split("");for(var m,q=0;q<d.length;q++){m=d[q];switch(m){case "a":m=c.daysShort[f];break;case "A":m=c.days[f];break;case "b":m=c.monthsShort[b];break;case "B":m=c.months[b];break;case "C":m=1+Math.floor(k/100);break;case "d":m=10>e?"0"+e:e;break;case "e":m=e;break;case "H":m=10>g?"0"+g:g;break;case "I":m=10>p?"0"+p:p;break;case "j":m=100>h?10>h?"00"+h:"0"+h:h;break;case "k":m=g;break;case "l":m=p;break;case "m":m=
9>b?"0"+(1+b):1+b;break;case "M":m=10>n?"0"+n:n;break;case "p":case "P":m=l?"PM":"AM";break;case "s":m=Math.floor(a.getTime()/1E3);break;case "S":m=10>r?"0"+r:r;break;case "u":m=f+1;break;case "w":m=f;break;case "y":m=(""+k).substr(2,2);break;case "Y":m=k}d[q]=m}return d.join("")}function O(a,d){var c=a.__pickmeup.element,b=a.__pickmeup.options,e;B(d);a:{var k;switch(b.mode){case "multiple":k=d.valueOf();for(e=0;e<b.date.length;++e)if(b.date[e].valueOf()===k){b.date.splice(e,1);break a}b.date.push(d);
break;case "range":b.lastSel||(b.date[0]=d);d<=b.date[0]?(b.date[1]=b.date[0],b.date[0]=d):b.date[1]=d;b.lastSel=!b.lastSel;break;default:b.date=d.valueOf()}}d=H(b);C(a,"input")&&(a.value="single"==b.mode?d.formatted_date:d.formatted_date.join(b.separator));D(c,"change",d);b.flat||!b.hide_on_select||"range"==b.mode&&b.lastSel||b.bound.hide()}function P(a,d){d=d.target;n(d,"pmu-button")||(d=J(d,".pmu-button"));if(!n(d,"pmu-button")||n(d,"pmu-disabled"))return!1;a=a.__pickmeup.options;var c=J(d,".pmu-instance"),
b=c.parentElement,c=Array.prototype.slice.call(b.querySelectorAll(".pmu-instance")).indexOf(c);C(d.parentElement,"nav")?n(d,"pmu-month")?(r(a.current,c-Math.floor(a.calendars/2)),n(b,"pmu-view-years")?(a.current="single"!=a.mode?new Date(a.date[a.date.length-1]):new Date(a.date),a.select_day?(b.classList.remove("pmu-view-years"),l(b,"pmu-view-days")):a.select_month&&(b.classList.remove("pmu-view-years"),l(b,"pmu-view-months"))):n(b,"pmu-view-months")?a.select_year?(b.classList.remove("pmu-view-months"),
l(b,"pmu-view-years")):a.select_day&&(b.classList.remove("pmu-view-months"),l(b,"pmu-view-days")):n(b,"pmu-view-days")&&(a.select_month?(b.classList.remove("pmu-view-days"),l(b,"pmu-view-months")):a.select_year&&(b.classList.remove("pmu-view-days"),l(b,"pmu-view-years")))):n(d,"pmu-prev")?a.bound.prev(!1):a.bound.next(!1):n(b,"pmu-view-years")?(a.current.setFullYear(d.__pickmeup_year),a.select_month?(b.classList.remove("pmu-view-years"),l(b,"pmu-view-months")):a.select_day?(b.classList.remove("pmu-view-years"),
l(b,"pmu-view-days")):a.bound.update_date(a.current)):n(b,"pmu-view-months")?(a.current.setMonth(d.__pickmeup_month),a.current.setFullYear(d.__pickmeup_year),a.select_day?(b.classList.remove("pmu-view-months"),l(b,"pmu-view-days")):a.bound.update_date(a.current),r(a.current,Math.floor(a.calendars/2)-c)):(b=new Date(a.current),b.setYear(d.__pickmeup_year),b.setMonth(d.__pickmeup_month),b.setDate(d.__pickmeup_day),a.bound.update_date(b));a.bound.fill();return!0}function H(a){var d;if("single"==a.mode)return d=
new Date(a.date),{formatted_date:E(d,a.format,a.locales[a.locale]),date:d};d={formatted_date:[],date:[]};a.date.forEach(function(c){c=new Date(c);d.formatted_date.push(E(c,a.format,a.locales[a.locale]));d.date.push(c)});return d}function I(a,d){var c=a.__pickmeup.element;if(d||n(c,"pmu-hidden")){var b=a.__pickmeup.options,e=M(a),k=window.pageXOffset,f=window.pageYOffset,g=document.documentElement.clientWidth,l=document.documentElement.clientHeight,p=e.top,h=e.left;b.bound.fill();C(a,"input")&&((d=
a.value)&&b.bound.set_date(d),q(a,a,"keydown",function(a){9==a.which&&b.bound.hide()}),b.lastSel=!1);if(D(c,"show")&&!b.flat){switch(b.position){case "top":p-=c.offsetHeight;break;case "left":h-=c.offsetWidth;break;case "right":h+=a.offsetWidth;break;case "bottom":p+=a.offsetHeight}p+c.offsetHeight>f+l&&(p=e.top-c.offsetHeight);p<f&&(p=e.top+a.offsetHeight);h+c.offsetWidth>k+g&&(h=e.left-c.offsetWidth);h<k&&(h=e.left+a.offsetWidth);c.style.top=p+"px";c.style.left=h+"px";c.classList.remove("pmu-hidden");
q(a,document.documentElement,"click",b.bound.hide);q(a,window,"resize",b.bound.forced_show)}}}function Q(a,d){var c=a.__pickmeup.element,b=a.__pickmeup.options;d&&d.target&&(d.target==a||c.compareDocumentPosition(d.target)&16)||!D(c,"hide")||(l(c,"pmu-hidden"),z(a,document.documentElement,"click",b.bound.hide),z(a,window,"resize",b.bound.forced_show),b.lastSel=!1)}function R(a){var d=a.__pickmeup.options;z(a,document.documentElement,"click",d.bound.hide);z(a,window,"resize",d.bound.forced_show);d.bound.forced_show()}
function S(a){a=a.__pickmeup.options;"single"!=a.mode&&(a.date=[],a.lastSel=!1,a.bound.fill())}function T(a,d){"undefined"==typeof d&&(d=!0);var c=a.__pickmeup.element;a=a.__pickmeup.options;n(c,"pmu-view-years")?v(a.current,-12):n(c,"pmu-view-months")?v(a.current,-1):n(c,"pmu-view-days")&&r(a.current,-1);d&&a.bound.fill()}function U(a,d){"undefined"==typeof d&&(d=!0);var c=a.__pickmeup.element;a=a.__pickmeup.options;n(c,"pmu-view-years")?v(a.current,12):n(c,"pmu-view-months")?v(a.current,1):n(c,
"pmu-view-days")&&r(a.current,1);d&&a.bound.fill()}function V(a,d){var c=a.__pickmeup.options;a=H(c);return"string"===typeof d?(a=a.date,a instanceof Date?E(a,d,c.locales[c.locale]):a.map(function(a){return E(a,d,c.locales[c.locale])})):a[d?"formatted_date":"date"]}function W(a,d,c){var b=a.__pickmeup.options;if(!(d instanceof Array)||0<d.length)if(b.date=u(d,b),"single"!=b.mode)for(b.date instanceof Array?(b.date[0]=b.date[0]||u(new Date,b),"range"==b.mode&&(b.date[1]=b.date[1]||u(b.date[0],b))):
(b.date=[b.date],"range"==b.mode&&b.date.push(u(b.date[0],b))),d=0;d<b.date.length;++d)b.date[d]=L(b.date[d],b.min,b.max);else b.date instanceof Array&&(b.date=b.date[0]),b.date=L(b.date,b.min,b.max);else b.date=[];if(!b.select_day)if(b.date instanceof Array)for(d=0;d<b.date.length;++d)b.date[d].setDate(1);else b.date.setDate(1);if("multiple"==b.mode)for(d=0;d<b.date.length;++d)b.date.indexOf(b.date[d])!==d&&(b.date.splice(d,1),--d);c?b.current=u(c,b):(c="single"===b.mode?b.date:b.date[b.date.length-
1],b.current=c?new Date(c):new Date);b.current.setDate(1);b.bound.fill();C(a,"input")&&!1!==b.default_date&&(c=H(b),d=a.value,b="single"==b.mode?c.formatted_date:c.formatted_date.join(b.separator),d||D(a.__pickmeup.element,"change",c),d!=b&&(a.value=b))}function X(a){var d=a.__pickmeup.element;z(a);y(d);delete a.__pickmeup}function L(a,d,c){return d&&d>a?new Date(d):c&&c<a?new Date(c):a}function F(a,d){"string"==typeof a&&(a=document.querySelector(a));if(!a.__pickmeup){var c,b={};for(c in F.defaults)b[c]=
c in d?d[c]:F.defaults[c];for(c in b)d=a.getAttribute("data-pmu-"+c),null!==d&&(b[c]=d);"days"!=b.view||b.select_day||(b.view="months");"months"!=b.view||b.select_month||(b.view="years");"years"!=b.view||b.select_year||(b.view="days");"days"!=b.view||b.select_day||(b.view="months");b.calendars=Math.max(1,parseInt(b.calendars,10)||1);b.mode=/single|multiple|range/.test(b.mode)?b.mode:"single";b.min&&(b.min=u(b.min,b),b.select_day||b.min.setDate(1));b.max&&(b.max=u(b.max,b),b.select_day||b.max.setDate(1));
c=document.createElement("div");a.__pickmeup={options:b,events:[],element:c};c.__pickmeup_target=a;l(c,"pickmeup");b.class_name&&l(c,b.class_name);b.bound={fill:N.bind(a,a),update_date:O.bind(a,a),click:P.bind(a,a),show:I.bind(a,a),forced_show:I.bind(a,a,!0),hide:Q.bind(a,a),update:R.bind(a,a),clear:S.bind(a,a),prev:T.bind(a,a),next:U.bind(a,a),get_date:V.bind(a,a),set_date:W.bind(a,a),destroy:X.bind(a,a)};l(c,"pmu-view-"+b.view);c.innerHTML=b.instance_template(b).repeat(b.calendars);q(a,c,"click",
b.bound.click);q(a,c,"onselectstart"in Element.prototype?"selectstart":"mousedown",function(a){a.preventDefault()});b.flat?(l(c,"pmu-flat"),a.appendChild(c)):(l(c,"pmu-hidden"),document.body.appendChild(c),q(a,a,"click",I.bind(a,a,!1)),q(a,a,"input",b.bound.update),q(a,a,"change",b.bound.update));b.bound.set_date(b.date,b.current)}b=a.__pickmeup.options;return{hide:b.bound.hide,show:b.bound.show,clear:b.bound.clear,update:b.bound.update,prev:b.bound.prev,next:b.bound.next,get_date:b.bound.get_date,
set_date:b.bound.set_date,destroy:b.bound.destroy}}F.defaults={current:null,date:new Date,default_date:new Date,flat:!1,first_day:1,prev:"\x26#9664;",next:"\x26#9654;",mode:"single",select_year:!0,select_month:!0,select_day:!0,view:"days",calendars:1,format:"d-m-Y",title_format:"B, Y",position:"bottom",class_name:"",separator:" - ",hide_on_select:!1,min:null,max:null,render:function(){},locale:"en",locales:{en:{days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),daysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),
daysMin:"Su Mo Tu We Th Fr Sa".split(" "),months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")}},instance_template:function(a){var d=a.locales[a.locale].daysMin.slice();a.first_day&&d.push(d.shift());return'\x3cdiv class\x3d"pmu-instance"\x3e\x3cnav\x3e\x3cdiv class\x3d"pmu-prev pmu-button"\x3e'+a.prev+'\x3c/div\x3e\x3cdiv class\x3d"pmu-month pmu-button"\x3e\x3c/div\x3e\x3cdiv class\x3d"pmu-next pmu-button"\x3e'+
a.next+'\x3c/div\x3e\x3c/nav\x3e\x3cnav class\x3d"pmu-day-of-week"\x3e\x3cdiv\x3e'+d.join("\x3c/div\x3e\x3cdiv\x3e")+"\x3c/div\x3e\x3c/nav\x3e\x3c/div\x3e"},instance_content_template:function(a,d){var c=document.createElement("div");l(c,d);for(d=0;d<a.length;++d)l(a[d],"pmu-button"),c.appendChild(a[d]);return c}};return F});