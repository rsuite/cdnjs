/*! jQuery UI Virtual Keyboard Alt Key Popup v2.0.0 */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&"object"==typeof module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){"use strict";var p=e.keyboard;e.extend(p.css,{altKeyPopup:"ui-keyboard-popup",altKeyOverlay:"ui-keyboard-overlay",altKeyPopupOpen:"ui-keyboard-popup-open"}),p.altKeys=e.extend({a:"å æ ā ă ą à á â ã ä",A:"Å Æ Ā Ă Ą À Á Â Ã Ä",c:"ç ć ĉ ċ č",C:"Ç Ć Ĉ Ċ Č",d:"ď ð ď",D:"Ď Ð Ď",e:"ė ę ĕ ě ə è é ê ë ē",E:"Ė Ę Ĕ Ě Ǝ È É Ê Ë Ē",g:"ģ ğ ĝ ġ",G:"Ģ Ğ Ĝ Ġ",h:"ĥ ħ",H:"Ĥ Ħ",i:"ı į ī ï î í ì ĩ ĭ",I:"İ Į Ī Ï Î Í Ì Ĩ Ĭ",j:"ĵ",J:"Ĵ",k:"ķ",K:"Ķ",l:"Ł Ľ Ļ Ĺ Ŀ",L:"ł ľ ļ ĺ ŀ",n:"ŉ ň ņ ń ñ",N:"ŉ Ň Ņ Ń Ñ",o:"œ ő ø ö õ ô ó ò ō ŏ",O:"Œ Ő Ø Ö Õ Ô Ó Ò Ō Ŏ",r:"ŕ ř ŗ",R:"Ŕ Ř Ŗ",s:"ś š ş ß § ŝ",S:"Ś Š Ş ẞ § Ŝ",t:"þ ť ț ţ ŧ",T:"Þ Ť Ț Ţ Ŧ",u:"ų ű ů ū ü û ú ù ũ ŭ",U:"Ų Ű Ů Ū Ü Û Ú Ù Ũ Ŭ",w:"ŵ",W:"Ŵ",y:"ý",Y:"Ý",z:"ź ż ž",Z:"Ź Ż Ž","!":"¡",$:"€ £ ¤ ¥ ¢ ₡ ₱ ₩ ₹ ₪ ₭ ₮ ₦ ₤","?":"¿","'":"〈 「 『 “",'"':"〉 」 』 ”","(":"《 【 〔",")":"》 】 〕"},p.altKeys),e.fn.addAltKeyPopup=function(o){var t={holdTime:500,popupVisible:"popup-visible",popupHidden:"popup-hidden",popupPosition:null};return this.each(function(){var a=e(this).data("keyboard");if(a){if(a.altkeypopup_options=e.extend({},t,a.altkeypopup_options,o),a.altkeypopup_namespace)return a.altkeypopup_setup();a.altkeypopup_namespace=a.namespace+"AltKeyPopup",a.extensionNamespace.push(a.altkeypopup_namespace),a.altkeypopup_setup=function(){var o,t="mousedown touchstart ".split(" ").join(a.altkeypopup_namespace+" "),n="mouseup touchend touchcancel ".split(" ").join(a.altkeypopup_namespace+" ");a.options.repeatRate=0,a.unbindButton(a.altkeypopup_namespace).bindButton(t,function(){clearTimeout(o);var t=e(this),n=t.attr("data-value")||"",i=a.altkeypopup_options.holdTime;n in p.altKeys&&(i?o=setTimeout(function(){a.altKeyPopup_popup(n,t)},i):a.altKeyPopup_popup(n,t))}).bindButton(n,function(){clearTimeout(o)}),a.altkeypopup_blockingFlag=!1,a.$preview.unbind("keypress keydown keyup ".split(" ").join(a.altkeypopup_namespace+" ").trim()).bind("keypress keydown keyup ".split(" ").join(a.altkeypopup_namespace+" "),function(t){if("keyup"===t.type)return clearTimeout(o),a.altkeypopup_blockingFlag=!1,"Escape"!==t.key;var n=p.builtLayouts[a.layout],i=e(t.target),u=t.key,s=t.key;return"keydown"===t.type&&s in p.altKeys?a.altkeypopup_blockingFlag!==u&&(a.altkeypopup_blockingFlag=u,!0):a.altkeypopup_blockingFlag?(n.hasMappedKeys&&n.mappedKeys.hasOwnProperty(s)&&(s=n.mappedKeys[s]),s in p.altKeys&&(clearTimeout(o),o=setTimeout(function(){a.altkeypopup_blockingFlag===u&&a.altKeyPopup_popup(s,i)},a.altkeypopup_options.holdTime)),!0):void 0})},a.altKeyPopup_close=function(){a.altkeypopup_blockingFlag=!1,a.altKeyPopup_$overlay=null,setTimeout(function(){if(a.$keyboard.length){a.$keyboard.removeClass(p.css.altKeyPopupOpen);var e=a.$keyboard.find("."+p.css.altKeyOverlay);e&&e.remove()}},1),e(document).unbind(a.altkeypopup_namespace),a.$preview.focus(),a.options.ignoreEsc=a.altKeyPopup_savedIgnoreEsc,a.$el.trigger(a.altkeypopup_options.popupHidden,[a])},a.altKeyPopup_popup=function(o,t){if(!a.$keyboard.find("."+p.css.altKeyOverlay).length){var n,i,u,s,l,y,r,c,d,k=p.css,b={$kb:a.$keyboard,kbWidth:a.$keyboard.outerWidth(),kbHeight:a.$keyboard.outerHeight(),$key:t};a.altKeyPopup_$overlay=e('<div class="'+k.altKeyOverlay+'" />').css({width:b.kbWidth,height:b.kbHeight}).appendTo(a.$keyboard).bind("click touchstart",function(){a.altKeyPopup_close()}),d="inactive hidden ".split(" ").join(a.altkeypopup_namespace+" "),a.$keyboard.addClass(p.css.altKeyPopupOpen),a.$el.unbind(d).bind(d,function(){a.altKeyPopup_close()}),"bksp"!==o&&p.keyaction.bksp(a),i=e('<div class="'+k.altKeyPopup+" "+a.options.css.container+'" />'),n=p.altKeys[o].split(/\s+/),a.buildRow(i,0,n,[]),u=i.appendTo(a.altKeyPopup_$overlay).children().bind("mousedown touchstart",function(){a.altKeyPopup_close()}).bind("mouseover mouseleave",function(p){u.removeClass(a.options.css.buttonHover),"mouseleave"!==p.type&&e(this).addClass(a.options.css.buttonHover)}),a.altKeyPopup_navigate(!0),a.altKeyPopup_savedIgnoreEsc=a.options.ignoreEsc,a.options.ignoreEsc=!0,e(document).unbind(a.altkeypopup_namespace).bind("keydown"+a.altkeypopup_namespace,function(){return!1}).bind("keyup"+a.altkeypopup_namespace,function(e){return"Escape"===e.key?(e.which=0,a.altKeyPopup_close()):a.altKeyPopup_navigate(e),!1}),b.$popup=i,r=i.outerWidth(),(s=t.position().left-r/2)+r>b.kbWidth&&(s=b.kbWidth-r)<0&&i.css({width:b.kbWidth,height:"auto"}),l=t.position().top-t.outerHeight()-5,c=i.outerHeight(),y=a.$keyboard.find("."+k.keySet).position().top,l+c>b.kbHeight&&(l=b.kbHeight-c)<y&&i.css({height:b.popupHeight,width:"auto"}),b.popupWidth=i.outerWidth(),b.popupHeight=i.outerHeight(),b.popupLeft=s<0?0:s,b.popupTop=l<y?y:l,i.css({position:"absolute",left:b.popupLeft,top:b.popupTop}),"function"==typeof a.altkeypopup_options.popupPosition&&a.altkeypopup_options.popupPosition(a,b),a.$preview.blur(),a.$el.trigger(a.altkeypopup_options.popupVisible,[a])}},a.altKeyPopup_navigate=function(e){var o,t=p.css,n=(p.navigationKeys,a.options.css.buttonHover),i=a.$keyboard.find("."+t.altKeyPopup).find("."+t.keyButton),u=i.length-1;if(!0===e)return i.eq(0).addClass(n),void(a.altKeyPopup_currentIndex=0);if(o=a.altKeyPopup_currentIndex,"Enter"===e.key)return a.insertText(i.eq(o).attr("data-value")),a.altKeyPopup_close(),!0;switch(e.key){case"End":o=u;break;case"Home":o=0;break;case"ArrowLeft":o-=1;break;case"ArrowRight":o+=1}o<0&&(o=0),o>u&&(o=u),a.altKeyPopup_currentIndex=o,i.removeClass(n).eq(o).addClass(n)},a.options.alwaysOpen&&a.isVisible()&&a.altkeypopup_setup(),a.$el.unbind(p.events.kbBeforeVisible+a.altkeypopup_namespace).bind(p.events.kbBeforeVisible+a.altkeypopup_namespace,function(){a.altkeypopup_setup()})}})}});