(function(b){function v(a){if(!b.ignore_visitor)if(a.key){a.count||(a.count=1);var c=N(a,["key","count","sum","dur","segmentation"]);c.timestamp=O();var d=new Date;c.hour=d.getHours();c.dow=d.getDay();r.push(c);h("cly_event",r);i("Adding event: ",a)}else i("Event must have key property")}function P(){if(A){var a={name:A,segment:wa};b.check_consent("views")&&v({key:"[CLY]_view",dur:n()-E,segmentation:a});A=null}}function p(a){if(!b.ignore_visitor)if(!b.app_key||!b.device_id)i("app_key or device_id is missing");
else{a.app_key=b.app_key;a.device_id=b.device_id;a.sdk_name=xa;a.sdk_version=ya;b.check_consent("location")?(b.country_code&&(a.country_code=b.country_code),b.city&&(a.city=b.city),null!==b.ip_address&&(a.ip_address=b.ip_address)):a.location="";a.timestamp=O();var c=new Date;a.hour=c.getHours();a.dow=c.getDay();s.length>Q&&s.shift();s.push(a);h("cly_queue",s,!0)}}function F(){if(b.ignore_visitor)R=!1;else{R=!0;var a=0;if("undefined"!==typeof b.onload&&0<b.onload.length){for(a=0;a<b.onload.length;a++)if("function"===
typeof b.onload[a])b.onload[a]();b.onload=[]}if("undefined"!==typeof b.q&&0<b.q.length){var c,d=b.q;b.q=[];for(a=0;a<d.length;a++)if(c=d[a],i("Processing queued call",c),"function"===typeof c)c();else if(c.constructor===Array&&0<c.length)if("undefined"!==typeof b[c[0]])b[c[0]].apply(null,c.slice(1));else{var f=c[0].replace("userData.","");"undefined"!==typeof b.userData[f]&&b.userData[f].apply(null,c.slice(1))}}B&&(S&&D)&&(a=n(),a-x>T&&(b.session_duration(a-x),x=a));0<r.length&&(r.length<=G?(p({events:JSON.stringify(r)}),
r=[]):(a=r.splice(0,G),p({events:JSON.stringify(a)})),h("cly_event",r));0<s.length&&(U&&n()>ca)&&(U=!1,a=s.shift(),da(w)&&(y&&(clearTimeout(y),y=null),a.consent=JSON.stringify(w),w={}),i("Processing request",a),ea(a,function(a,c){i("Request Finished",c,a);a&&(s.unshift(c),ca=n()+V);h("cly_queue",s,!0);U=!0}));setTimeout(F,W)}}function fa(){return h("cly_id")||ga()}function ga(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var b=(a+16*Math.random())%
16|0;a=Math.floor(a/16);return("x"==c?b:b&3|8).toString(16)})}function X(){var a={};a._app_version=b.app_version;a._ua=navigator.userAgent;if(screen.width){var c=screen.width?parseInt(screen.width):0,d=screen.height?parseInt(screen.height):0;if(0!==c&&0!==d){if(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&window.devicePixelRatio)c=Math.round(c*window.devicePixelRatio),d=Math.round(d*window.devicePixelRatio);else if(90===Math.abs(window.orientation))var f=c,c=d,d=f;a._resolution=
""+c+"x"+d}}window.devicePixelRatio&&(a._density=window.devicePixelRatio);c=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;"undefined"!==typeof c&&(a._locale=c);if("undefined"!==typeof document.referrer&&document.referrer.length&&(c=ha.exec(document.referrer))&&c[11]&&c[11]!=window.location.hostname){c=!1;if(C&&C.length)for(d=0;d<C.length;d++)try{if(RegExp(C[d]).test(document.referrer)){i("Ignored:",document.referrer);c=!0;break}}catch(g){}c||(a._store=
document.referrer)}i("Got metrics",a);return a}function i(){b.debug&&"undefined"!==typeof console&&(arguments[1]&&"object"==typeof arguments[1]&&(arguments[1]=JSON.stringify(arguments[1])),console.log(Array.prototype.slice.call(arguments).join("\n")))}function n(){return Math.floor((new Date).getTime()/1E3)}function O(){var a=(new Date).getTime();H>=a?H++:H=a;return H}function I(a,c,d){if(b.check_consent("crashes")&&a){var d=d||ia,f="";"object"===typeof a?"undefined"!==typeof a.stack?f=a.stack:("undefined"!==
typeof a.name&&(f+=a.name+":"),"undefined"!==typeof a.message&&(f+=a.message+"\n"),"undefined"!==typeof a.fileName&&(f+="in "+a.fileName+"\n"),"undefined"!==typeof a.lineNumber&&(f+="on "+a.lineNumber),"undefined"!==typeof a.columnNumber&&(f+=":"+a.columnNumber)):f=a+"";c=c?!0:!1;a=X();f={_resolution:a._resolution,_error:f,_app_version:a._app_version,_run:n()-ja,_not_os_specific:!0};if(a=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery)f._bat=Math.floor(100*a.level);
"undefined"!==typeof navigator.onLine&&(f._online=navigator.onLine?!0:!1);f._background=document.hasFocus()?!1:!0;0<J.length&&(f._logs=J.join("\n"));J=[];f._nonfatal=c;f._view=(window.location.pathname||"")+(window.location.search||"")+(window.location.hash||"");"undefined"!==typeof d&&(f._custom=d);try{var g=document.createElement("canvas").getContext("experimental-webgl");f._opengl=g.getParameter(g.VERSION)}catch(e){}p({crash:JSON.stringify(f)})}}function ea(a,c){try{i("Sending XML HTTP request");
var d=window.XMLHttpRequest?new window.XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null,f=ka(a),g="GET";2E3<=f.length?g="POST":b.force_post&&(g="POST");"GET"===g?d.open("GET",b.url+la+"?"+f,!0):(d.open("POST",b.url+la,!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"));d.onreadystatechange=function(){4===this.readyState&&200<=this.status&&300>this.status?"function"===typeof c&&c(!1,a):4===this.readyState&&(i("Failed Server XML HTTP request",this.status),
"function"===typeof c&&c(!0,a))};"GET"==g?d.send():d.send(f)}catch(e){i("Failed XML HTTP request",e),"function"===typeof c&&c(!0,a)}}function ka(a){var c=[],b;for(b in a)c.push(b+"="+encodeURIComponent(a[b]));return c.join("&")}function ma(a){return"/"==a.substr(a.length-1)?a.substr(0,a.length-1):a}function N(a,b){for(var d={},f,g=0;g<b.length;g++)f=b[g],"undefined"!==typeof a[f]&&(d[f]=a[f]);return d}function Y(a){"undefined"==typeof a.pageY&&("number"==typeof a.clientX&&document.documentElement)&&
(a.pageX=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a.pageY=a.clientY+document.body.scrollTop+document.documentElement.scrollTop);return a}function Z(){var a=document;return Math.max(Math.max(a.body.scrollHeight,a.documentElement.scrollHeight),Math.max(a.body.offsetHeight,a.documentElement.offsetHeight),Math.max(a.body.clientHeight,a.documentElement.clientHeight))}function $(){var a=document;return Math.max(Math.max(a.body.scrollWidth,a.documentElement.scrollWidth),Math.max(a.body.offsetWidth,
a.documentElement.offsetWidth),Math.max(a.body.clientWidth,a.documentElement.clientWidth))}function na(){var a=document;return Math.min(Math.min(a.body.clientHeight,a.documentElement.clientHeight),Math.min(a.body.offsetHeight,a.documentElement.offsetHeight),window.innerHeight)}function oa(a){h("cly_token",a)}function da(a){if(a)for(var b in a)return!0;return!1}function pa(a,b){var d=document.createElement("script"),f;d.setAttribute("type","text/javascript");d.setAttribute("src",a);b&&(d.onreadystatechange=
d.onload=function(){f||b();f=!0});document.getElementsByTagName("head")[0].appendChild(d)}function qa(){var a=document.getElementById("cly-loader");if(!a){i("setting up loader");var a=document.head||document.getElementsByTagName("head")[0],b=document.createElement("style");b.type="text/css";b.styleSheet?b.styleSheet.cssText="#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}":
b.appendChild(document.createTextNode("#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}"));
a.appendChild(b);a=document.createElement("div");a.setAttribute("id","cly-loader");document.body.appendChild(a)}a.style.display="block"}function ra(){var a=document.getElementById("cly-loader");a&&(a.style.display="none")}var ya="18.04",xa="javascript_native_web",sa=!1,B=!1,la="/i",W=500,Q=1E3,s=[],r=[],J=[],z={},C=[],ia=null,S=!0,x,ta=0,A=null,E=0,aa=0,ca=0,V=60,K=20,L=0,T=60,G=10,H=0,U=!0,wa,R=!1,w={},q={},ha=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,
ua=/(CountlySiteBot|nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO)/,D=!0,ja;b.features="sessions events views scrolls clicks forms crashes attribution users star-rating location".split(" ");
for(var j={},ba=0;ba<b.features.length;ba++)j[b.features[ba]]={};b.init=function(a){if(!sa&&(ja=n(),sa=!0,s=h("cly_queue")||[],z={},r=h("cly_event")||[],a=a||{},W=a.interval||b.interval||W,Q=a.queue_size||b.queue_size||Q,V=a.fail_timeout||b.fail_timeout||V,K=a.inactivity_time||b.inactivity_time||K,T=a.session_update||b.session_update||T,G=a.max_events||b.max_events||G,b.ignore_prefetch=a.ignore_prefetch||b.ignore_prefetch||!0,b.debug=a.debug||b.debug||!1,b.app_key=a.app_key||b.app_key||null,b.device_id=
a.device_id||b.device_id||fa(),b.url=ma(a.url||b.url||""),b.app_version=a.app_version||b.app_version||"0.0",b.country_code=a.country_code||b.country_code||null,b.city=a.city||b.city||null,b.ip_address=a.ip_address||b.ip_address||null,b.ignore_bots=a.ignore_bots||b.ignore_bots||!0,b.force_post=a.force_post||b.force_post||!1,b.q=b.q||[],b.onload=b.onload||[],b.ignore_visitor=a.ignore_visitor||b.ignore_visitor||!1,b.require_consent=a.require_consent||b.require_consent||!1,a.ignore_referrers&&a.ignore_referrers.constructor===
Array?C=a.ignore_referrers:b.ignore_referrers&&b.ignore_referrers.constructor===Array&&(C=b.ignore_referrers),""===b.url&&(i("Please provide server URL"),b.ignore_visitor=!0),h("cly_ignore")&&(b.ignore_visitor=!0),b.ignore_prefetch&&("undefined"!==typeof document.visibilityState&&"prerender"===document.visibilityState)&&(b.ignore_visitor=!0),b.ignore_bots&&ua.test(navigator.userAgent)&&(b.ignore_visitor=!0),window.name&&0===window.name.indexOf("cly:")?b.passed_data=JSON.parse(window.name.replace("cly:",
"")):location.hash&&0===location.hash.indexOf("#cly:")&&(b.passed_data=JSON.parse(location.hash.replace("#cly:",""))),b.passed_data&&(b.passed_data.token&&b.passed_data.purpose)&&(b.passed_data.token!=h("cly_old_token")&&(oa(b.passed_data.token),h("cly_old_token",b.passed_data.token)),"heatmap"===b.passed_data.purpose&&(b.ignore_visitor=!0,qa(),pa(b.url+"/views/heatmap.js",ra))),!b.ignore_visitor)){i("Countly initialized");b.onload.constructor!==Array&&(b.onload=[]);b.q.constructor!==Array&&(b.q=
[]);F();h("cly_id",b.device_id);a=0;if(location.search)for(var c=location.search.substring(1).split("&"),a=0;a<c.length;a++){var d=c[a].split("=");"cly_id"==d[0]?h("cly_cmp_id",d[1]):"cly_uid"==d[0]&&h("cly_cmp_uid",d[1])}if("undefined"!==typeof b.onload&&0<b.onload.length){for(a=0;a<b.onload.length;a++)if("function"===typeof b.onload[a])b.onload[a]();b.onload=[]}}};b.group_features=function(a){if(a)for(var b in a)j[b]?i("Feature name "+b+" is already reserved"):"string"===typeof a[b]?j[b]={features:[a[b]]}:
a[b]&&a[b].constructor===Array&&a[b].length?j[b]={features:a[b]}:i("Incorrect feature list for "+b+" value: "+a[b]);else i("Incorrect features: "+a)};b.check_consent=function(a){if(!b.require_consent)return!0;if(j[a])return j[a]&&j[a].optin?!0:!1;i("No feature available for "+a);return!1};b.check_any_consent=function(){if(!b.require_consent)return!0;for(var a in j)if(j[feature]&&j[feature].optin)return!0;return!1};b.add_consent=function(a){i("Adding consent for "+a);if(a.constructor===Array)for(var c=
0;c<a.length;c++)b.add_consent(a[c]);else j[a]?j[a].features?(j[a].optin=!0,b.add_consent(j[a].features)):!0!==j[a].optin&&(w[a]=!0,j[a].optin=!0,va(),setTimeout(function(){"sessions"===a&&q.begin_session?(b.begin_session.apply(b,q.begin_session),q.begin_session=null):"views"===a&&q.track_pageview&&(A=null,b.track_pageview.apply(b,q.track_pageview),q.track_pageview=null);q.change_id&&(b.change_id.apply(b,q.change_id),q.change_id=null)},1)):i("No feature available for "+a)};b.remove_consent=function(a){i("Removing consent for "+
a);if(a.constructor===Array)for(var c=0;c<a.length;c++)b.remove_consent(a[c]);else j[a]?(j[a].features?b.remove_consent(j[a].features):!1!==j[a].optin&&(w[a]=!1,va()),j[a].optin=!1):i("No feature available for "+a)};var y,va=function(){y&&(clearTimeout(y),y=null);y=setTimeout(function(){da(w)&&(p({consent:JSON.stringify(w)}),w={})},1E3)};b.begin_session=function(a){if(b.check_consent("sessions")){if(!B){i("Session started");x=n();B=!0;S=a?!1:!0;var c={begin_session:1};c.metrics=JSON.stringify(X());
p(c)}}else q.begin_session=arguments};b.session_duration=function(a){b.check_consent("sessions")&&B&&(i("Session extended",a),p({session_duration:a}))};b.end_session=function(a){b.check_consent("sessions")&&B&&(a=a||n()-x,i("Ending session"),P(),B=!1,p({end_session:1,session_duration:a}))};b.change_id=function(a,c){if(b.device_id!=a){c||(b.end_session(),z={});var d=b.device_id;b.device_id=a;h("cly_id",b.device_id);i("Changing id");c?b.check_any_consent()?p({old_device_id:d}):q.change_id=arguments:
b.begin_session(!S)}};b.add_event=function(a){b.check_consent("events")&&v(a)};b.start_event=function(a){z[a]?i("Timed event with key "+a+" already started"):z[a]=n()};b.end_event=function(a){"string"==typeof a&&(a={key:a});a.key?z[a.key]?(a.dur=n()-z[a.key],b.add_event(a),delete z[a.key]):i("Timed event with key "+a.key+" was not started"):i("Event must have key property")};b.user_details=function(a){b.check_consent("users")&&(i("Adding userdetails: ",a),p({user_details:JSON.stringify(N(a,"name username email organization phone picture gender byear custom".split(" ")))}))};
b.report_conversion=function(a,c){b.check_consent("attribution")&&(a=a||h("cly_cmp_id")||"cly_organic",c=c||h("cly_cmp_uid"),a&&c?p({campaign_id:a,campaign_user:c}):a&&p({campaign_id:a}))};var t={},u=function(a,c,d){b.check_consent("users")&&(t[a]||(t[a]={}),"$push"==d||"$pull"==d||"$addToSet"==d?(t[a][d]||(t[a][d]=[]),t[a][d].push(c)):t[a][d]=c)};b.userData={set:function(a,b){t[a]=b},set_once:function(a){u(a,1,"$setOnce")},increment:function(a){u(a,1,"$inc")},increment_by:function(a,b){u(a,b,"$inc")},
multiply:function(a,b){u(a,b,"$mul")},max:function(a,b){u(a,b,"$max")},min:function(a,b){u(a,b,"$min")},push:function(a,b){u(a,b,"$push")},push_unique:function(a,b){u(a,b,"$addToSet")},pull:function(a,b){u(a,b,"$pull")},save:function(){b.check_consent("users")&&p({user_details:JSON.stringify({custom:t})});t={}}};b.track_errors=function(a){ia=a;window.onerror=function(a,b,f,g,e){if("undefined"!==typeof e)I(e,!1);else{var g=g||window.event&&window.event.errorCharacter,k="";"undefined"!==typeof a&&(k+=
a+"\n");"undefined"!==typeof b&&(k+="at "+b);"undefined"!==typeof f&&(k+=":"+f);"undefined"!==typeof g&&(k+=":"+g);k+="\n";try{for(var i=[],l=arguments.callee.caller;l;)i.push(l.name),l=l.caller;k+=i.join("\n")}catch(h){}I(k,!1)}}};b.log_error=function(a,b){I(a,!0,b)};b.add_log=function(a){b.check_consent("crashes")&&J.push(a)};b.stop_time=function(){D&&(D=!1,ta=n()-x,aa=n()-E)};b.start_time=function(){D||(D=!0,x=n()-ta,E=n()-aa,aa=0)};b.track_sessions=function(){function a(){document[d]?b.stop_time():
b.start_time()}function c(){L>=K&&b.start_time();L=0}b.begin_session();b.start_time();m(window,"beforeunload",function(){b.end_session()});m(window,"unload",function(){b.end_session()});var d="hidden";d in document?document.addEventListener("visibilitychange",a):(d="mozHidden")in document?document.addEventListener("mozvisibilitychange",a):(d="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",a):(d="msHidden")in document?document.addEventListener("msvisibilitychange",a):
"onfocusin"in document?(m(window,"focusin",function(){b.start_time()}),m(window,"focusout",function(){b.stop_time()})):(m(window,"focus",function(){b.start_time()}),m(window,"blur",function(){b.stop_time()}),m(window,"pageshow",function(){b.start_time()}),m(window,"pagehide",function(){b.stop_time()}));m(window,"mousemove",c);m(window,"click",c);m(window,"keydown",c);m(window,"scroll",c);setInterval(function(){L++;L>=K&&b.stop_time()},6E4)};b.track_pageview=function(a,c){P();a&&a.constructor===Array&&
(c=a,a=null);a=a||window.location.pathname;if(c&&c.length)for(var d=0;d<c.length;d++)try{if(RegExp(c[d]).test(a)){i("Ignored:",a);return}}catch(f){}A=a;E=n();d={name:a,visit:1,domain:window.location.hostname};if("undefined"!==typeof document.referrer&&document.referrer.length){var g=ha.exec(document.referrer);g&&(g[11]&&g[11]!=window.location.hostname)&&(d.start=1)}b.check_consent("views")?v({key:"[CLY]_view",segmentation:d}):q.track_pageview=arguments};b.track_view=function(a,c){b.track_pageview(a,
c)};b.track_clicks=function(a){var a=a||document,c=!0;m(a,"click",function(a){if(c){c=!1;Y(a);if("undefined"!==typeof a.pageX&&"undefined"!==typeof a.pageY){var f=Z(),g=$();b.check_consent("clicks")&&v({key:"[CLY]_action",segmentation:{type:"click",x:a.pageX,y:a.pageY,width:g,height:f,domain:window.location.hostname,view:window.location.pathname}})}setTimeout(function(){c=!0},1E3)}})};b.track_scrolls=function(a){function c(){if(d){d=!1;var a=Z(),c=$(),k=na();b.check_consent("scrolls")&&v({key:"[CLY]_action",
segmentation:{type:"scroll",y:f+k,width:c,height:a,domain:window.location.hostname,view:window.location.pathname}})}}var a=a||window,d=!0,f=0;m(a,"scroll",function(){f=Math.max(f,window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)});m(a,"beforeunload",c);m(a,"unload",c)};b.track_links=function(a){a=a||document;m(a,"click",function(a){var d=M(a).closest("a");d&&(Y(a),b.check_consent("clicks")&&v({key:"linkClick",segmentation:{href:d.href,text:d.innerText,id:d.id,x:a.pageX,y:a.pageY,
view:window.location.pathname}}),"undefined"!==typeof d.href&&"_blank"!==d.target&&!a.metaKey&&!a.altKey&&!a.ctrlKey&&!a.shiftKey&&0!==d.href.replace(window.location.href.split("#")[0],"").indexOf("#")&&b.end_session())})};b.track_forms=function(a){function c(a){return a.name||a.id||a.type||a.nodeName}a=a||document;m(a,"submit",function(a){var a=M(a),f={id:a.id,name:a.name,action:a.action,method:a.method,view:window.location.pathname},g;if("undefined"!==typeof a.elements){for(var e=0;e<a.elements.length;e++)if((g=
a.elements[e])&&"password"!=g.type)if("undefined"===typeof f["input:"+c(g)]&&(f["input:"+c(g)]=[]),"select"==g.nodeName.toLowerCase())if("undefined"!==typeof g.multiple){var k=[];if("undefined"!==typeof g.options)for(var i=0;i<g.options.length;i++)g.options[i].selected&&k.push(g.options[i].value);f["input:"+c(g)].push(k.join(", "))}else f["input:"+c(g)].push(g.options[g.selectedIndex].value);else"input"==g.nodeName.toLowerCase()?"undefined"!==typeof g.type?"checkbox"==g.type.toLowerCase()||"radio"==
g.type.toLowerCase()?g.checked&&f["input:"+c(g)].push(g.value):f["input:"+c(g)].push(g.value):f["input:"+c(g)].push(g.value):"textarea"==g.nodeName.toLowerCase()?f["input:"+c(g)].push(g.value):"undefined"!==typeof g.value&&f["input:"+c(g)].push(g.value);for(var l in f)"undefined"!=typeof f[l].join&&(f[l]=f[l].join(", "))}b.check_consent("forms")&&v({key:"formSubmit",segmentation:f});b.end_session()})};b.collect_from_forms=function(a,c){a=a||document;m(a,"submit",function(d){var d=M(d),f={},g=!1,e;
if("undefined"!==typeof d.elements){var k={},h=a.getElementsByTagName("LABEL"),l;for(l=0;l<h.length;l++)h[l].htmlFor&&""!==h[l].htmlFor&&(k[h[l].htmlFor]=h[l].innerText||h[l].textContent||h[l].innerHTML);for(l=0;l<d.elements.length;l++)if((e=d.elements[l])&&"password"!=e.type&&-1==e.className.indexOf("cly_user_ignore")){var j="";if("select"==e.nodeName.toLowerCase())if("undefined"!==typeof e.multiple){j=[];if("undefined"!==typeof e.options)for(h=0;h<e.options.length;h++)e.options[h].selected&&j.push(e.options[h].value);
j=j.join(", ")}else j=e.options[e.selectedIndex].value;else"input"==e.nodeName.toLowerCase()?"undefined"!==typeof e.type?"checkbox"==e.type.toLowerCase()||"radio"==e.type.toLowerCase()?e.checked&&(j=e.value):j=e.value:j=e.value:"textarea"==e.nodeName.toLowerCase()?j=e.value:"undefined"!==typeof e.value&&(j=e.value);if(e.className&&-1!=e.className.indexOf("cly_user_")){e=e.className.split(" ");for(h=0;h<e.length;h++)if(0===e[h].indexOf("cly_user_")){f[e[h].replace("cly_user_","")]=j;g=!0;break}}else if(e.type&&
"email"==e.type.toLowerCase()||e.name&&-1!=e.name.toLowerCase().indexOf("email")||e.id&&-1!=e.id.toLowerCase().indexOf("email")||e.id&&k[e.id]&&-1!=k[e.id].toLowerCase().indexOf("email")||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(j))f.email||(f.email=j),g=!0;else if(e.name&&-1!=e.name.toLowerCase().indexOf("username")||e.id&&-1!=e.id.toLowerCase().indexOf("username")||e.id&&k[e.id]&&-1!=k[e.id].toLowerCase().indexOf("username"))f.username||(f.username=j),g=!0;else if(e.name&&(-1!=e.name.toLowerCase().indexOf("tel")||
-1!=e.name.toLowerCase().indexOf("phone")||-1!=e.name.toLowerCase().indexOf("number"))||e.id&&(-1!=e.id.toLowerCase().indexOf("tel")||-1!=e.id.toLowerCase().indexOf("phone")||-1!=e.id.toLowerCase().indexOf("number"))||e.id&&k[e.id]&&(-1!=k[e.id].toLowerCase().indexOf("tel")||-1!=k[e.id].toLowerCase().indexOf("phone")||-1!=k[e.id].toLowerCase().indexOf("number")))f.phone||(f.phone=j),g=!0;else if(e.name&&(-1!=e.name.toLowerCase().indexOf("org")||-1!=e.name.toLowerCase().indexOf("company"))||e.id&&
(-1!=e.id.toLowerCase().indexOf("org")||-1!=e.id.toLowerCase().indexOf("company"))||e.id&&k[e.id]&&(-1!=k[e.id].toLowerCase().indexOf("org")||-1!=k[e.id].toLowerCase().indexOf("company")))f.organization||(f.organization=j),g=!0;else if(e.name&&-1!=e.name.toLowerCase().indexOf("name")||e.id&&-1!=e.id.toLowerCase().indexOf("name")||e.id&&k[e.id]&&-1!=k[e.id].toLowerCase().indexOf("name"))f.name||(f.name=""),f.name+=j+" ",g=!0}}g&&(i("Gathered user data",f),c?b.user_details({custom:f}):b.user_details(f));
b.end_session()})};b.collect_from_facebook=function(a){FB&&FB.api&&FB.api("/me",function(c){var d={};c.name&&(d.name=c.name);c.email&&(d.email=c.email);"male"==c.gender?d.gender="M":"female"==c.gender&&(d.gender="F");if(c.birthday){var f=c.birthday.split("/").pop();f&&4==f.length&&(d.byear=f)}c.work&&(c.work[0]&&c.work[0].employer&&c.work[0].employer.name)&&(d.organization=c.work[0].employer.name);if(a){d.custom={};for(var g in a){for(var f=a[g].split("."),e=c,h=0;h<f.length&&!(e=e[f[h]],"undefined"===
typeof e);h++);"undefined"!==typeof e&&(d.custom[g]=e)}}b.user_details(d)})};b.opt_out=function(){b.ignore_visitor=!0;h("cly_ignore",!0)};b.opt_in=function(){h("cly_ignore",!1);b.ignore_visitor=!1;b.ignore_prefetch&&("undefined"!==typeof document.visibilityState&&"prerender"===document.visibilityState)&&(b.ignore_visitor=!0);b.ignore_bots&&ua.test(navigator.userAgent)&&(b.ignore_visitor=!0);!b.ignore_visitor&&!R&&F()};Element.prototype.closest||(Element.prototype.closest=function(a){for(var b=this,
a=a.toUpperCase();b;){if(b.nodeName.toUpperCase()==a)return b;b=b.parentElement}});var m=function(a,b,d){"undefined"!==typeof a.addEventListener?a.addEventListener(b,d,!1):a.attachEvent("on"+b,d)},M=function(a){return a?"undefined"!==typeof a.target?a.target:a.srcElement:window.event.srcElement},h=function(a,b,d){function f(a,b,c){var d=new Date;d.setTime(d.getTime()+864E5*c);c="; expires="+d.toGMTString();document.cookie=a+"="+b+c+"; path=/"}var d=d||!1,g=!1,e,g=!0;try{"undefined"!==typeof localStorage&&
localStorage.setItem("testLocal",!0)}catch(h){g=!1}"undefined"!==typeof b&&null!==b&&("object"===typeof b&&(b=JSON.stringify(b)),g?localStorage.setItem(a,b):d||f(a,b,30));if("undefined"===typeof b){if(g)e=localStorage.getItem(a);else if(!d)a:{a+="=";b=document.cookie.split(";");d=0;for(g=b.length;d<g;d++){for(e=b[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(a)){e=e.substring(a.length,e.length);break a}}e=null}try{e=JSON.parse(e)}catch(i){}return e}null===b&&(g?localStorage.removeItem(a):
d||f(a,"",-1))};b._internals={store:h,getDocWidth:$,getDocHeight:Z,getViewportHeight:na,get_page_coord:Y,get_event_target:M,add_event:m,getProperties:N,stripTrailingSlash:ma,prepareParams:ka,sendXmlHttpRequest:ea,recordError:I,getMsTimestamp:O,getTimestamp:n,log:i,getMetrics:X,generateUUID:ga,getId:fa,heartBeat:F,toRequestQueue:p,reportViewDuration:P,loadJS:pa,loadCSS:function(a,b){var d=document.createElement("link"),f;d.setAttribute("rel","stylesheet");d.setAttribute("href",a);b&&(d.onreadystatechange=
d.onload=function(){f||b();f=!0});document.getElementsByTagName("head")[0].appendChild(d)},getLastView:function(){return A},setToken:oa,getToken:function(){var a=h("cly_token");h("cly_token",null);return a},showLoader:qa,hideLoader:ra,add_cly_events:v}})(window.Countly=window.Countly||{});
